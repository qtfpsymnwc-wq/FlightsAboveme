name = "flightsabove"
main = "worker.js"
compatibility_date = "2026-02-04"

[vars]
# AeroDataBox (RapidAPI)
AERODATA_HOST = "aerodatabox.p.rapidapi.com"
AERODATA_DAILY_BUDGET = "400"  # daily upstream AeroDataBox call cap

# ADS-B fallback provider (OpenSky backup)
# Optional — defaults to https://api.adsb.lol if omitted
ADSBLOL_BASE = "https://api.adsb.lol"

# Secrets configured via:
#   wrangler secret put <NAME>
#
# Required:
#   AERODATA_KEY
#
# OpenSky (OAuth2 – recommended):
#   OPENSKY_CLIENT_ID
#   OPENSKY_CLIENT_SECRET
#
# (Optional legacy OpenSky basic auth if you still have it)
#   OPENSKY_USER
#   OPENSKY_PASS

# ---------------------------------------------------------------------------
# Permanent bindings lock (IMPORTANT)
#
# The Cloudflare dashboard can show bindings "disappear" after deploys if
# wrangler deploys a configuration that does not explicitly declare them.
#
# To prevent drift, we declare bindings in:
#   1) default scope (covers plain `wrangler deploy`)
#   2) env.production scope (covers `wrangler deploy --env production`)
#
# This file uses the most compatible Wrangler TOML syntax:
#   [[kv_namespaces]] and [[d1_databases]]
# ---------------------------------------------------------------------------

[[kv_namespaces]]
binding = "AIRCRAFT_KV"
id = "71b6264513e94b99ab667fd2424ee755"

[[d1_databases]]
binding = "DB"
database_name = "flights_db"
database_id = "982b56a9-c663-4c88-97d5-0a5b85e85be3"

[env.production]

[[env.production.kv_namespaces]]
binding = "AIRCRAFT_KV"
id = "71b6264513e94b99ab667fd2424ee755"

[[env.production.d1_databases]]
binding = "DB"
database_name = "flights_db"
database_id = "982b56a9-c663-4c88-97d5-0a5b85e85be3"